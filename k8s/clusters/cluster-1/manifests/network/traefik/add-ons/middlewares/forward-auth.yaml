---
apiVersion: traefik.containo.us/v1alpha1
kind: Middleware
metadata:
  name: authentik
  namespace: network
spec:
  forwardAuth:
    address: https://auth.${CLUSTER_NAME}.${INGRESS_DOMAIN}/outpost.goauthentik.io/auth/traefik
    trustForwardHeader: true
    authResponseHeadersRegex: ^.*$
    # Below is from the Authentik docs
    # authResponseHeaders:
    #      - X-authentik-username
    #      - X-authentik-groups
    #      - X-authentik-email
    #      - X-authentik-name
    #      - X-authentik-uid
    #      - X-authentik-jwt
    #      - X-authentik-meta-jwks
    #      - X-authentik-meta-outpost
    #      - X-authentik-meta-provider
    #      - X-authentik-meta-app
    #      - X-authentik-meta-versio