---
apiVersion: metal.sidero.dev/v1alpha1
kind: Server
metadata:
  labels:
    control-plane: "true"
    worker: "false"
  name: 57437ffc-f76a-44a2-83d7-068af670a66a
spec:
  cordoned: false
  accepted: true
  configPatches:
    - op: create
      path: /machine/install/diskSelector/size
      value: '<= 500GB'
    # - op: add
    #   path: /machine/install/disk
    #   value: /dev/sda
    - op: add
      path: /machine/network/hostname
      value: cp3.${CLUSTER_1_HARDWARE_DOMAIN}
    - op: add
      path: /machine/network/interfaces
      value:
        - interface: eth0
          dhcp: true
        # - interface: eth1
          # vlans:
          #   # Home LAN
          #   - vlanId: 2
          #     dhcp: true
          #   # IoT Network
          #   - vlanId: 100
          #     dhcp: true
    - op: add
      path: /machine/sysctls
      value:
        fs.inotify.max_user_watches: "1048576"
        fs.inotify.max_user_instances: "8192"
        vm.max_map_count: "524288"
  cpu:
    manufacturer: QEMU
    version:  pc-q35-6.2
  hostname: cp3.${CLUSTER_1_HARDWARE_DOMAIN}
  pxeBootAlways: true
  system:
    family: Unknown
    manufacturer: Dell
    productName: PowerEdge R720xd
    serialNumber: Cluster-1
    skuNumber: Unknown
    version: pc-q35-6.2 
