---
apiVersion: metal.sidero.dev/v1alpha1
kind: Server
metadata:
  labels:
    control-plane: "true"
  name: e58e1837-58d6-34ca-4cc7-1c697aae5522
spec:
  cordoned: true
  accepted: true
  configPatches:
    - op: replace
      path: /machine/install/disk
      value: /dev/nvme0n1
    - op: add
      path: /machine/network/hostname
      value: cp2.${CLUSTER_1_HARDWARE_DOMAIN}
    - op: add
      path: /machine/network/interfaces
      value:
        - interface: eth0
          dhcp: true
          # disableSearchDomain: true   <--- This isnt the right spot to put this
          # vlans:
          #   # Home LAN
          #   - vlanId: 2
          #     dhcp: true
          #   # IoT Network
          #   - vlanId: 100
          #     dhcp: true
    - op: add
      path: /machine/network/disableSearchDomain
      value: true
    - op: add
      path: /machine/sysctls
      value:
        fs.inotify.max_user_watches: "1048576"
        fs.inotify.max_user_instances: "8192"
        vm.max_map_count: "524288"
  cpu:
    manufacturer: Intel(R) Corporation
    version: 11th Gen Intel(R) Core(TM) i5-1135G7 @ 2.40GHz
  hostname: cp2.${CLUSTER_1_HARDWARE_DOMAIN}
  pxeBootAlways: true
  system:
    family: PA
    manufacturer: Intel(R) Client Systems
    productName: NUC11PAHi5
    serialNumber: G6PA145003A3
    skuNumber: RNUC11PAHi5000
    version: M15533-306
