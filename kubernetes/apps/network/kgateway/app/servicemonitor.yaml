# ---
# apiVersion: monitoring.coreos.com/v1
# kind: ServiceMonitor
# metadata:
#   name: kgateway
# spec:
#   endpoints:
#     - interval: 1m
#       path: /metrics
#       port: http
#       scheme: http
#       scrapeTimeout: 30s
#   jobLabel: kgateway
#   namespaceSelector:
#     matchNames:
#       - network
#   selector:
#     matchLabels:
#       app.kubernetes.io/name: kgateway
---
# TODO: Use ServiceMonitor instead of PodMonitor once chart for 2.3.0 is released
apiVersion: monitoring.coreos.com/v1
kind: PodMonitor
metadata:
  name: kgateway
spec:
  jobLabel: kgateway
  namespaceSelector:
    matchNames:
      - network
  podMetricsEndpoints:
    - port: metrics
      path: /metrics
      honorLabels: true
  selector:
    matchLabels:
      app.kubernetes.io/name: kgateway
